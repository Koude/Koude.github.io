---
title: 群晖公网访问设置
description: 无Quick Connect的情况下，如何公网访问群晖。
categories:
 - 教程
tags: 群晖 NAS
comments: true
---

> 一般来说，要实现公网访问，最简单的当然是被访问设备自身有公网IP，但群晖设备基本都是连接到路由器使用，ipv4时代，IP地址资源紧缺，不可能所有设备都分配公网IP（👏马上进入ipv6时代👏）。因此，只能想办法使上级设备即路由器获取公网IP，然后通过路由器端口转发实现公网访问。（本文不涉及内网穿透内容，如需相关教程请自行搜索。）

<!-- more -->

## 路由器获取公网IP

目前家庭上网一般模式为 `上网设备 - 路由器（可无） - 光猫 - 运营商`， 其中光猫负责拨号，在这种router（路由）模式下，光猫实际上是同时完成了调制解调器和路由器的工作，获取到运营商分配的IP（不一定是公网IP）。

打开 http://ip111.cn ， 最左侧显示的ip地址即为当前的公网ip，登录光猫查看与运营商分配的ip是否一致，如一致，可省略联系运营商要求公网IP的步骤。如不一致，需联系运营商要求分配公网IP。如不成功，请`ctrl+w` 然后搜索内网穿透等教程。

光猫获取公网IP后，路由器还是内网IP。因此下一步是将光猫设置为bridge（桥接）模式，由路由器进行拨号。改桥接的步骤每种光猫大体一致，但管理员的账号密码不一样，需根据自己的设备型号自行搜索解决，也可尝试联系运营商要求改为桥接模式。

改为桥接模式后，路由器填入PPPoE账号密码拨号即可获取公网IP。

## 将路由器的地址“固定”下来

为实现资源的利用最大化，运营商分配给我们的公网IP一般来说是动态变化的，我们不可能每次都通过IP进行访问，即便申请了域名解析也只能解析到一个固定IP。（DDNS）动态域名解析就是解决这个问题的。通过对设备的设置，每次IP地址变化都会通知DDNS服务器，DDNS服务器会对域名-IP地址的对应关系进行修改。通过域名访问，虽然每次IP地址不同，但访问的都是我们的路由器。

#### 注册域名

免费的域名注册商推荐 freenom，免费账号可申请最长一年期的域名，到期可免费申请延续。

#### DDNS

 经测试，被腾讯收购的dnspod仍然可以免费ddns。 



## 端口转发 

通过以上步骤，我们实现了理论上公网访问路由器，对于藏在路由器内的设备，通过端口转发，可以实现公网访问。



#### 群晖端口

群晖的管理网页http默认端口为5000，https默认端口为5001，要实现外网访问，需在域名后加:5000或:5001方可。形如http://baidu.com:5000, https://baidu.com:5001 . 以上两端口可修改，但不可修改为群晖系统保留端口80、443等。修改路径为`控制面板 - 网络 -  DSM设置`，如下图所示：

![修改群晖端口](/images/modify-nas-port.png)

#### 外网免端口访问

群晖接路由器使用，

根据个人理解， http://baidu.com 等同于 http://baidu.com:80 , https://baidu.com等同于https://baidu.com:443 .

#### Photo Station

